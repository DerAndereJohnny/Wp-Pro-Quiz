!function(e){e=e||window;var t=[],o=!1,n=!1;function r(){if(!o){o=!0;for(var e=0;e<t.length;e++)t[e].fn.call(window,t[e].ctx);t=[]}}function s(){"complete"===document.readyState&&r()}e.wpProQuizReady=function(e,i){o?setTimeout(function(){e(i)},1):(t.push({fn:e,ctx:i}),"complete"===document.readyState?setTimeout(r,1):n||(document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):(document.attachEvent("onreadystatechange",s),window.attachEvent("onload",r)),n=!0))}}(window),wpProQuizReady(function(){for(var e=window.wpProQuizInitList||[],i=0;i<e.length;i++)jQuery(e[i].id).wpProQuizFront(e[i].init)}),function(j){j.wpProQuizFront=function(e,i){var s,a,t,o,n,r,u,z=j(e),l=i,w=this,d=null,c=1,p=!1,h=[],f="",m={},Q={},v={randomAnswer:0,randomQuestion:0,disabledAnswerMark:0,checkBeforeStart:0,preview:0,cors:0,isAddAutomatic:0,quizSummeryHide:0,skipButton:0,reviewQustion:0,autoStart:0,forcingQuestionSolve:0,hideQuestionPositionOverview:0,formActivated:0,maxShowQuestion:0,sortCategories:0},_={isQuizStart:0,isLocked:0,loadLock:0,isPrerequisite:0,isUserStartLocked:0},P='input[name="check"]',g='input[name="next"]',q=".wpProQuiz_questionList",x='input[name="skip"]',k='input[name="wpProQuiz_pageLeft"]',S='input[name="wpProQuiz_pageRight"]',b={back:z.find('input[name="back"]'),next:z.find(g),quiz:z.find(".wpProQuiz_quiz"),questionList:z.find(".wpProQuiz_list"),results:z.find(".wpProQuiz_results"),quizStartPage:z.find(".wpProQuiz_text"),timelimit:z.find(".wpProQuiz_time_limit"),toplistShowInButton:z.find(".wpProQuiz_toplistShowInButton"),listItems:j()},y=0,I=1,L=(s=l.timelimit,{stop:function(){s&&(window.clearInterval(a),b.timelimit.hide())},start:function(){var t,o,n,r;s&&(t=1e3*s,o=b.timelimit.find("span").text(w.methode.parseTime(s)),n=b.timelimit.find(".wpProQuiz_progress"),b.timelimit.show(),r=+new Date,a=window.setInterval(function(){var e=+new Date-r,i=t-e;500<=e&&o.text(w.methode.parseTime(Math.ceil(i/1e3))),n.css("width",i/t*100+"%"),i<=0&&(instance.stop(),w.methode.finishQuiz(!0))},16))}}),T=(r=!(o=-1),u=n=t=a=0,{getStartTime:function(){return u},questionStart:function(e){-1!=o&&this.questionStop(),o=e,t=+new Date},questionStop:function(){-1!=o&&(m[o].time+=Math.round((new Date-t)/1e3),o=-1)},startQuiz:function(){r&&this.stopQuiz(),u=+new Date,n=+new Date,r=!0},stopQuiz:function(){r&&(m.complete.quizTime+=Math.round((new Date-n)/1e3),r=!1)},init:function(){}}),C=new function(){var n=this,o=[],r=[],s=[],a=[],t=0,u=0,d=0,c=0,p=0,l=[];function i(e){var i="",t=l[e],o="#000";1===n.reviewBoxStatus?t.correct?(o="#FFFFFF",i="#30C945"):t.correct||(o="#FFFFFF",i="#C94530"):t.review?(o="#FFFFFF",i="#FFB800"):t.solved&&(o="#FFFFFF",i="#30C945"),a.eq(e).css("background-color",i),a.eq(e).css("color",o)}function h(e){e.preventDefault();var e=e.pageY-u,i=d*(e=t<(e=e<0?0:e)?t:e);s.attr("style","margin-top: "+-i+"px !important"),r.css({top:e})}function f(e){e.preventDefault(),j(document).unbind(".scrollEvent")}this.init=function(){o=z.find(".wpProQuiz_reviewQuestion"),r=o.find("div"),s=o.find("ol"),a=s.children(),r.mousedown(function(e){e.preventDefault(),e.stopPropagation(),u=e.pageY-r.offset().top+c,j(document).bind("mouseup.scrollEvent",f),j(document).bind("mousemove.scrollEvent",h)}),a.click(function(e){a.removeClass("wpProQuiz_reviewQuestionTarget"),j(this).addClass("wpProQuiz_reviewQuestionTarget"),w.methode.showQuestion(j(this).index())}),z.bind("questionSolved",function(e){l[e.values.index].solved=e.values.solved,i(e.values.index)}),z.bind("questionIsCorrect",function(e){l[e.values.index].correct=e.values.correct,i(e.values.index)}),z.bind("questionIsWrong",function(e){l[e.values.index].correct=e.values.correct,i(e.values.index)}),z.bind("resetItemStatus",function(e){0==n.reviewBoxStatus&&n.reset(1)}),z.bind("changeQuestion",function(e){var i,t;a.removeClass("wpProQuiz_reviewQuestionTarget"),a.eq(e.values.index).addClass("wpProQuiz_reviewQuestionTarget"),e=e.values.index,e=a.eq(e),i=e.offset().top,t=o.offset().top,((i-=t)-4<0||100<32+i)&&(i=t-a.eq(0).offset().top-(t-s.offset().top)+e.position().top,t=(i=p<i?p:i)/d,s.attr("style","margin-top: "+-i+"px !important"),r.css({top:t}))}),z.bind("reviewQuestion",function(e){l[e.values.index].review=!l[e.values.index].review,i(e.values.index)}),o.bind("mousewheel DOMMouseScroll",function(e){e.preventDefault();var e=e.originalEvent,e=20*(e.wheelDelta?-e.wheelDelta/120:e.detail/3),e=c-s.offset().top+e,i=(e=(e=p<e?p:e)<0?0:e)/d;return s.attr("style","margin-top: "+-e+"px !important"),r.css({top:i}),!1})},this.show=function(e){var i;v.reviewQustion&&o.parent().show(),z.find(".wpProQuiz_reviewDiv .wpProQuiz_button2").show(),e||(s.attr("style","margin-top: 0px !important"),r.css({top:0}),e=s.outerHeight(),i=o.height(),t=i-r.height(),u=0,d=(p=e-i)/t,this.reset(),120<e&&r.show(),c=r.offset().top)},this.hide=function(){o.parent().hide()},this.toggle=function(){var e,i;v.reviewQustion&&(o.parent().toggle(),a.removeClass("wpProQuiz_reviewQuestionTarget"),z.find(".wpProQuiz_reviewDiv .wpProQuiz_button2").hide(),s.attr("style","margin-top: 0px !important"),r.css({top:0}),e=s.outerHeight(),i=o.height(),t=i-r.height(),u=0,d=(p=e-i)/t,120<e&&r.show(),c=r.offset().top)},this.reset=function(e){n.reviewBoxStatus=e=null==e?0:e;for(var i=0,t=a.length;i<t;i++)l[i]={};a.removeClass("wpProQuiz_reviewQuestionTarget").css("background-color",""),a.removeClass("wpProQuiz_reviewQuestionTarget").css("color",""),1===n.reviewBoxStatus?(j(".wpProQuiz_legendQuizIsRunning").hide(),j(".wpProQuiz_legendNowIsReviewTime").show()):(j(".wpProQuiz_legendQuizIsRunning").show(),j(".wpProQuiz_legendNowIsReviewTime").hide())}},F=new function(){var u=function(e){return!(e=j.trim(e))||0===e.length},d=0,c=1,p=2,l=3,h=4,f=5,w=6,m=7,Q=8;this.checkForm=function(){var a=!0;return z.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var e=j(this),i=1==e.data("required"),t=e.data("type"),o=!0,n=j.trim(e.val());switch(t){case d:case c:case m:i&&(o=!u(n));break;case p:!i&&u(n)||(o=!u(n)&&!isNaN(n));break;case h:!i&&u(n)||(o=!u(n)&&new RegExp(/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/).test(n.toLowerCase()));break;case l:i&&(o=e.is(":checked"));break;case f:case Q:i&&(o=void 0!==e.find('input[type="radio"]:checked').val());break;case w:var r=0,s=0;e.find("select").each(function(){r++,s+=u(j(this).val())?0:1}),(i||0<s)&&(o=r==s)}o?e.siblings(".wpProQuiz_invalidate").hide():(a=!1,e.siblings(".wpProQuiz_invalidate").show())}),a},this.getFormData=function(){var t={};return z.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var e=j(this),i=e.data("form_id");switch(e.data("type")){case d:case c:case m:case p:case h:t[i]=e.val();break;case l:t[i]=e.is(":checked")?1:0;break;case f:case Q:t[i]=e.find('input[type="radio"]:checked').val();break;case w:t[i]={day:e.find('select[name="wpProQuiz_field_'+i+'_day"]').val(),month:e.find('select[name="wpProQuiz_field_'+i+'_month"]').val(),year:e.find('select[name="wpProQuiz_field_'+i+'_year"]').val()}}}),t}},A=(w.methode={parseBitOptions:function(){var e;l.bo&&(v.randomAnswer=1&l.bo,v.randomQuestion=2&l.bo,v.disabledAnswerMark=4&l.bo,v.checkBeforeStart=8&l.bo,v.preview=16&l.bo,v.isAddAutomatic=64&l.bo,v.reviewQustion=128&l.bo,v.quizSummeryHide=256&l.bo,v.skipButton=512&l.bo,v.autoStart=1024&l.bo,v.forcingQuestionSolve=2048&l.bo,v.hideQuestionPositionOverview=4096&l.bo,v.formActivated=8192&l.bo,v.maxShowQuestion=16384&l.bo,v.sortCategories=32768&l.bo,(e=32&l.bo)&&null!=jQuery.support&&null!=jQuery.support.cors&&0==jQuery.support.cors&&(v.cors=e))},setClozeStyle:function(){z.find(".wpProQuiz_cloze input").each(function(){for(var e=j(this),i="",t=e.data("wordlen"),o=0;o<t;o++)i+="w";var n=j(document.createElement("span")).css("visibility","hidden").text(i).appendTo(j("body")),r=n.width();n.remove(),e.width(r+5)})},parseTime:function(e){var i=parseInt(e%60),t=parseInt(e/60%60),e=parseInt(e/3600%24);return(9<e?"":"0")+e+":"+((9<t?"":"0")+t)+":"+((9<i?"":"0")+i)},cleanupCurlyQuotes:function(e){return e=(e=(e=(e=e.replace(/\u2018/,"'")).replace(/\u2019/,"'")).replace(/\u201C/,'"')).replace(/\u201D/,'"'),j.trim(e).toLowerCase()},resetMatrix:function(e){e.each(function(){var e=j(this),i=e.find(".wpProQuiz_sortStringList");e.find(".wpProQuiz_sortStringItem").each(function(){i.append(j(this))})})},marker:function(e,i){v.disabledAnswerMark||(i?e.addClass("wpProQuiz_answerCorrect"):e.addClass("wpProQuiz_answerIncorrect"))},startQuiz:function(e){if(_.loadLock)_.isQuizStart=1;else{if(_.isQuizStart=0,_.isLocked)return b.quizStartPage.hide(),void z.find(".wpProQuiz_lock").show();if(_.isPrerequisite)return b.quizStartPage.hide(),void z.find(".wpProQuiz_prerequisite").show();if(_.isUserStartLocked)return b.quizStartPage.hide(),void z.find(".wpProQuiz_startOnlyRegisteredUser").show();if(v.maxShowQuestion&&!e)return b.quizStartPage.hide(),z.find(".wpProQuiz_loadQuiz").show(),void w.methode.loadQuizDataAjax(!0);if(!v.formActivated||l.formPos!=y||F.checkForm()){switch(w.methode.loadQuizData(),v.randomQuestion&&w.methode.random(b.questionList),v.randomAnswer&&w.methode.random(z.find(q)),v.sortCategories&&w.methode.sortCategories(),w.methode.random(z.find(".wpProQuiz_sortStringList")),w.methode.random(z.find('[data-type="sort_answer"]')),z.find(".wpProQuiz_listItem").each(function(e,i){var t=j(this);t.find(".wpProQuiz_question_page span:eq(0)").text(e+1),t.find("> h5 span").text(e+1),t.find(".wpProQuiz_questionListItem").each(function(e,i){j(this).find("> span:not(.wpProQuiz_cloze)").text(e+1+". ")})}),b.next=z.find(g),l.mode){case 3:z.find('input[name="checkSingle"]').show();break;case 2:z.find(P).show(),!v.skipButton&&v.reviewQustion&&z.find(x).show();break;case 1:z.find('input[name="back"]').slice(1).show();case 0:b.next.show()}!v.hideQuestionPositionOverview&&3!=l.mode||z.find(".wpProQuiz_question_page").hide();var e=b.next.last(),e=(f=e.val(),e.val(l.lbn),b.questionList.children());b.listItems=z.find(".wpProQuiz_list > li"),3==l.mode?w.methode.showSinglePage(0):(e=(d=e.eq(0).show()).find(q).data("question_id"),T.questionStart(e)),T.startQuiz(),z.find(".wpProQuiz_sortable").parents("ul").sortable({update:function(e,i){var t=j(this).parents(".wpProQuiz_listItem");z.trigger({type:"questionSolved",values:{item:t,index:t.index(),solved:!0}})}}).disableSelection(),z.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable({connectWith:".wpProQuiz_maxtrixSortCriterion:not(:has(li)), .wpProQuiz_sortStringList",placeholder:"wpProQuiz_placehold",update:function(e,i){var t=j(this).parents(".wpProQuiz_listItem");z.trigger({type:"questionSolved",values:{item:t,index:t.index(),solved:!0}})}}).disableSelection(),h=[],L.start(),m={complete:{points:0,correctQuestions:0,quizTime:0}},z.find(".wpProQuiz_questionList").each(function(){var e=j(this).data("question_id");m[e]={time:0,solved:0}}),Q={},j.each(l.catPoints,function(e,i){Q[e]=0}),b.quizStartPage.hide(),z.find(".wpProQuiz_loadQuiz").hide(),b.quiz.show(),C.show(),3!=l.mode&&z.trigger({type:"changeQuestion",values:{item:d,index:d.index()}})}}},showSingleQuestion:function(e){e=e?Math.ceil(e/l.qpp):1;this.showSinglePage(e)},showSinglePage:function(e){var i,t,o,n;$listItem=b.questionList.children().hide(),l.qpp?(e=e?+e:1,(i=Math.ceil(z.find(".wpProQuiz_list > li").length/l.qpp))<e||(n=z.find(k).hide(),t=z.find(S).hide(),o=z.find('input[name="checkSingle"]').hide(),1<e&&!p&&n.val(n.data("text").replace(/%d/,e-1)).show(),p||(e==i?o:t.val(t.data("text").replace(/%d/,e+1))).show(),c=e,n=l.qpp*(e-1),$listItem.slice(n,n+l.qpp).show(),w.methode.scrollTo(b.quiz))):$listItem.show()},nextQuestion:function(){this.showQuestionObject(d.next())},prevQuestion:function(){this.showQuestionObject(d.prev())},showQuestion:function(e){var i=b.listItems.eq(e);3==l.mode?l.qpp?w.methode.showSingleQuestion(e+1):w.methode.scrollTo(i,1):this.showQuestionObject(i)},showQuestionObject:function(e){if(!e.length&&v.forcingQuestionSolve&&v.quizSummeryHide&&v.reviewQustion)for(var i=0,t=z.find(".wpProQuiz_listItem").length;i<t;i++)if(!h[i])return alert(WpProQuizGlobal.questionsNotSolved),!1;d.hide(),d=e.show(),w.methode.scrollTo(b.quiz),z.trigger({type:"changeQuestion",values:{item:d,index:d.index()}}),d.length?(e=d.find(q).data("question_id"),T.questionStart(e)):w.methode.showQuizSummary()},skipQuestion:function(){z.trigger({type:"skipQuestion",values:{item:d,index:d.index()}}),w.methode.nextQuestion()},reviewQuestion:function(){z.trigger({type:"reviewQuestion",values:{item:d,index:d.index()}})},showQuizSummary:function(){if(T.questionStop(),T.stopQuiz(),v.quizSummeryHide||!v.reviewQustion)v.formActivated&&l.formPos==I?(C.hide(),b.quiz.hide(),w.methode.scrollTo(z.find(".wpProQuiz_infopage").show())):w.methode.finishQuiz();else{for(var i=z.find(".wpProQuiz_checkPage"),e=(i.find("ol:eq(0)").empty().append(z.find(".wpProQuiz_reviewQuestion ol li").clone().removeClass("wpProQuiz_reviewQuestionTarget")).children().click(function(e){i.hide(),b.quiz.show(),C.show(!0),w.methode.showQuestion(j(this).index())}),0),t=0,o=h.length;t<o;t++)h[t]&&e++;i.find("span:eq(0)").text(e),C.hide(),b.quiz.hide(),i.show(),w.methode.scrollTo(i)}},finishQuiz:function(e){T.questionStop(),T.stopQuiz(),L.stop(),1==l.mode&&z.trigger({type:"resetItemStatus"});var i=(+new Date-T.getStartTime())/1e3,i=l.timelimit&&i>l.timelimit?l.timelimit:i,i=(z.find(".wpProQuiz_quiz_time span").text(w.methode.parseTime(i)),e&&b.results.find(".wpProQuiz_time_limit_expired").show(),w.methode.checkQuestion(b.questionList.children(),!0),z.find(".wpProQuiz_correct_answer").text(m.complete.correctQuestions),m.complete.result=Math.round(m.complete.points/l.globalPoints*100*100)/100,m.complete.solved=0,z.find(".wpProQuiz_points span")),e=(i.eq(0).text(m.complete.points),i.eq(1).text(l.globalPoints),i.eq(2).text(m.complete.result+"%"),z.find(".wpProQuiz_resultsList > li").eq(w.methode.findResultIndex(m.complete.result))),t=F.getFormData();e.find(".wpProQuiz_resultForm").each(function(){var e=j(this),i=e.data("form_id"),i=t[i];"object"==typeof i&&(i=i.day+"-"+i.month+"-"+i.year),e.text(i).show()}),e.show(),w.methode.setAverageResult(m.complete.result,!1),this.setCategoryOverview(),w.methode.sendCompletedQuiz(),v.isAddAutomatic&&A.isUser&&w.methode.addToplist(),C.hide(),z.find(".wpProQuiz_checkPage, .wpProQuiz_infopage").hide(),b.quiz.hide(),b.results.show(),w.methode.scrollTo(b.results)},setCategoryOverview:function(){m.complete.categories={},z.find(".wpProQuiz_catOverview li").each(function(){var e=j(this),i=e.data("category_id");if(void 0===l.catPoints[i])return e.hide(),!0;var t=Math.round(Q[i]/l.catPoints[i]*100*100)/100;m.complete.categories[i]=t,e.find(".wpProQuiz_catPercent").text(t+"%"),e.show()})},questionSolved:function(e){h[e.values.index]=e.values.solved;var i=e.values.item.find(q),i=l.json[i.data("question_id")];m[i.id].solved=Number((e.values.fake?m[i.id]:e.values).solved)},sendCompletedQuiz:function(){var r,e;v.preview||(r=m,z.find(".wpProQuiz_questionList").each(function(){var e,i=j(this),t=i.data("question_id"),o=i.data("type"),n={};if("single"==o||"multiple"==o)i.find(".wpProQuiz_questionListItem").each(function(){n[j(this).data("pos")]=+j(this).find(".wpProQuiz_questionInput").is(":checked")});else if("free_answer"==o)n[0]=i.find(".wpProQuiz_questionInput").val();else{if("sort_answer"==o)return!0;if("matrix_sort_answer"==o)return!0;"cloze_answer"==o?(e=0,i.find(".wpProQuiz_cloze input").each(function(){n[e++]=j(this).val()})):"assessment_answer"==o&&(n[0]="",i.find(".wpProQuiz_questionInput:checked").each(function(){n[j(this).data("index")]=j(this).val()}))}r[t].data=n}),e=F.getFormData(),w.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"completedQuiz",data:{quizId:l.quizId,results:m,forms:e}}))},findResultIndex:function(e){for(var i=l.resultsGrade,t=-1,o=999999,n=0;n<i.length;n++){var r=i[n];r<=e&&e-r<o&&(o=e-r,t=n)}return t},showQustionList:function(){p=!p,b.toplistShowInButton.hide(),b.quiz.toggle(),z.find(".wpProQuiz_QuestionButton").hide(),b.questionList.children().hide(),d=b.listItems.eq(0).show(),C.toggle(),z.find(".wpProQuiz_question_page").hide()},random:function(e){e.each(function(){var e=j(this).children().get().sort(function(){return Math.round(Math.random())-.5});j(e).appendTo(e[0].parentNode)})},sortCategories:function(){var e=j(".wpProQuiz_list").children().get().sort(function(e,i){e=j(e).find(".wpProQuiz_questionList").data("question_id"),i=j(i).find(".wpProQuiz_questionList").data("question_id");return l.json[e].catId-l.json[i].catId});j(e).appendTo(e[0].parentNode)},restartQuiz:function(){b.results.hide(),b.quizStartPage.show(),b.questionList.children().hide(),b.toplistShowInButton.hide(),C.hide(),z.find(".wpProQuiz_questionInput, .wpProQuiz_cloze input").removeAttr("disabled").removeAttr("checked").css("background-color",""),z.find('.wpProQuiz_questionListItem input[type="text"]').val(""),z.find(".wpProQuiz_answerCorrect, .wpProQuiz_answerIncorrect").removeClass("wpProQuiz_answerCorrect wpProQuiz_answerIncorrect"),z.find(".wpProQuiz_listItem").data("check",!1),z.find(".wpProQuiz_response").hide().children().hide(),w.methode.resetMatrix(z.find(".wpProQuiz_listItem")),z.find(".wpProQuiz_sortStringItem, .wpProQuiz_sortable").removeAttr("style"),z.find(".wpProQuiz_clozeCorrect, .wpProQuiz_QuestionButton, .wpProQuiz_resultsList > li").hide(),z.find('.wpProQuiz_question_page, input[name="tip"]').show(),z.find(".wpProQuiz_resultForm").text("").hide(),b.results.find(".wpProQuiz_time_limit_expired").hide(),b.next.last().val(f),p=!1},checkQuestion:function(e,p){(e=null==e?d:e).each(function(){var e=j(this),i=e.find(q),t=l.json[i.data("question_id")],o=t.type;if(T.questionStop(),e.data("check"))return!0;"single"!=t.type&&"multiple"!=t.type||(o="singleMulti");o=o,r=t,n=e,s=i,a=!0,u=0,d=j.isArray(r.points),c={},{singleMulti:function(){var o=s.find(".wpProQuiz_questionInput").attr("disabled","disabled"),n=r.diffMode;s.children().each(function(e){var i=j(this),t=i.data("pos"),e=o.eq(e).is(":checked");r.correct[t]?(e?d&&(n?u=r.points[t]:u+=r.points[t]):a=!1,r.disCorrect?a=!0:w.methode.marker(i,!0)):e?(a=!!r.disCorrect||(w.methode.marker(i,!1),!1),n&&(u=r.points[t])):d&&!n&&(u+=r.points[t])})},sort_answer:function(){var e=s.children();e.each(function(e,i){var t=j(this);c[e]=t.data("pos"),e==t.data("pos")?(w.methode.marker(t,!0),d&&(u+=r.points[e])):(w.methode.marker(t,!1),a=!1)}),e.children().css({"box-shadow":"0 0",cursor:"auto"}),s.sortable("destroy"),e.sort(function(e,i){return j(e).data("pos")>j(i).data("pos")?1:-1}),s.append(e)},matrix_sort_answer:function(){var e=s.children(),o=new Array;c={0:-1},e.each(function(){var e=j(this),i=e.data("pos"),e=e.find(".wpProQuiz_maxtrixSortCriterion"),t=e.children();t.length&&(c[i]=t.data("pos")),t.length&&0<=j.inArray(String(i),String(t.data("correct")).split(","))?(w.methode.marker(e,!0),d&&(u+=r.points[i])):(a=!1,w.methode.marker(e,!1)),o[i]=e}),w.methode.resetMatrix(n),n.find(".wpProQuiz_sortStringItem").each(function(){var e=o[j(this).data("pos")];null!=e&&e.append(this)}).css({"box-shadow":"0 0",cursor:"auto"}),n.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable("destroy")},free_answer:function(){var e=s.children(),i=e.find(".wpProQuiz_questionInput").attr("disabled","disabled").val();0<=j.inArray(j.trim(i).toLowerCase(),r.correct)?w.methode.marker(e,!0):(w.methode.marker(e,!1),a=!1)},cloze_answer:function(){s.find(".wpProQuiz_cloze").each(function(e,i){var t=j(this).children(),o=t.eq(0),t=t.eq(1),n=w.methode.cleanupCurlyQuotes(o.val());0<=j.inArray(n,r.correct[e])?(d&&(u+=r.points[e]),v.disabledAnswerMark||o.css("background-color","#B0DAB0")):(v.disabledAnswerMark||o.css("background-color","#FFBABA"),a=!1,t.show()),o.attr("disabled","disabled")})},assessment_answer:function(){a=!0;var e=s.find(".wpProQuiz_questionInput").attr("disabled","disabled"),i=0;e.filter(":checked").each(function(){i+=parseInt(j(this).val())}),u=i}}[o](),!d&&a&&(u=r.points);var r,n,s,a,u,d,c,i={c:a,p:u,s:c};e.find(".wpProQuiz_response").show(),e.find(P).hide(),e.find(x).hide(),e.find(g).show(),m[t.id].points=i.p,m[t.id].correct=Number(i.c),m[t.id].data=i.s,m.complete.points+=i.p,Q[t.catId]+=i.p,i.c?(e.find(".wpProQuiz_correct").show(),m.complete.correctQuestions+=1,1==l.mode&&z.trigger({type:"questionIsCorrect",values:{item:e,index:e.index(),correct:!0}})):(e.find(".wpProQuiz_incorrect").show(),1==l.mode&&z.trigger({type:"questionIsWrong",values:{item:e,index:e.index(),correct:!1}})),e.find(".wpProQuiz_responsePoints").text(i.p),e.data("check",!0),p||z.trigger({type:"questionSolved",values:{item:e,index:e.index(),solved:!0,fake:!0}})})},showTip:function(){var e=j(this),i=e.siblings(".wpProQuiz_question").find(q).data("question_id");e.siblings(".wpProQuiz_tipp").toggle("fast"),m[i].tip=1,j(document).bind("mouseup.tipEvent",function(e){var i=z.find(".wpProQuiz_tipp"),t=z.find('input[name="tip"]');i.is(e.target)||0!=i.has(e.target).length||t.is(e.target)||(i.hide("fast"),j(document).unbind(".tipEvent"))})},ajax:function(e,i,t){t=t||"json",v.cors&&(jQuery.support.cors=!0),j.post(WpProQuizGlobal.ajaxurl,e,i,t),v.cors&&(jQuery.support.cors=!1)},checkQuizLock:function(){_.loadLock=1,w.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"quizCheckLock",data:{quizId:l.quizId}},function(e){null!=e.lock&&(_.isLocked=e.lock.is,e.lock.pre&&z.find('input[name="restartQuiz"]').hide()),null!=e.prerequisite&&(_.isPrerequisite=1,z.find(".wpProQuiz_prerequisite span").text(e.prerequisite)),null!=e.startUserLock&&(_.isUserStartLocked=e.startUserLock),_.loadLock=0,_.isQuizStart&&w.methode.startQuiz()})},loadQuizData:function(){w.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"loadQuizData",data:{quizId:l.quizId}},function(e){e.toplist&&w.methode.handleToplistData(e.toplist),null!=e.averageResult&&w.methode.setAverageResult(e.averageResult,!0)})},setAverageResult:function(e,i){i=z.find(".wpProQuiz_resultValue:eq("+(i?0:1)+") > * ");i.eq(1).text(e+"%"),i.eq(0).css("width",240*e/100+"px")},handleToplistData:function(e){var i=z.find(".wpProQuiz_addToplist"),t=i.find(".wpProQuiz_addBox").show().children("div");e.canAdd?(i.show(),i.find(".wpProQuiz_addToplistMessage").hide(),i.find(".wpProQuiz_toplistButton").show(),A.token=e.token,A.isUser=0,e.userId?(t.hide(),A.isUser=1,v.isAddAutomatic&&i.hide()):(t.show(),t=t.children().eq(1),e.captcha?(t.find('input[name="wpProQuiz_captchaPrefix"]').val(e.captcha.code),t.find(".wpProQuiz_captchaImg").attr("src",e.captcha.img),t.find('input[name="wpProQuiz_captcha"]').val(""),t.show()):t.hide())):i.hide()},scrollTo:function(e,i){e=e.offset().top-100;(i||(window.pageYOffset||document.body.scrollTop)>e)&&j("html,body").animate({scrollTop:e},300)},addToplist:function(){var i,t;v.preview||(i=z.find(".wpProQuiz_addToplistMessage").text(WpProQuizGlobal.loadData).show(),t=z.find(".wpProQuiz_addBox").hide(),w.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"addInToplist",data:{quizId:l.quizId,token:A.token,name:t.find('input[name="wpProQuiz_toplistName"]').val(),email:t.find('input[name="wpProQuiz_toplistEmail"]').val(),captcha:t.find('input[name="wpProQuiz_captcha"]').val(),prefix:t.find('input[name="wpProQuiz_captchaPrefix"]').val(),points:m.complete.points,totalPoints:l.globalPoints}},function(e){i.text(e.text),e.clear?(t.hide(),w.methode.updateToplist()):t.show(),e.captcha&&(t.find(".wpProQuiz_captchaImg").attr("src",e.captcha.img),t.find('input[name="wpProQuiz_captchaPrefix"]').val(e.captcha.code),t.find('input[name="wpProQuiz_captcha"]').val(""))}))},updateToplist:function(){"function"==typeof wpProQuiz_fetchToplist&&wpProQuiz_fetchToplist()},registerSolved:function(){z.find('.wpProQuiz_questionInput[type="text"]').change(function(e){var i=j(this),t=i.parents(".wpProQuiz_listItem"),o=!1;""!=i.val()&&(o=!0),z.trigger({type:"questionSolved",values:{item:t,index:t.index(),solved:o}})}),z.find('.wpProQuiz_questionList[data-type="single"] .wpProQuiz_questionInput, .wpProQuiz_questionList[data-type="assessment_answer"] .wpProQuiz_questionInput').change(function(e){var i=j(this).parents(".wpProQuiz_listItem"),t=this.checked;z.trigger({type:"questionSolved",values:{item:i,index:i.index(),solved:t}})}),z.find(".wpProQuiz_cloze input").change(function(){var e=j(this).parents(".wpProQuiz_listItem"),i=!0;e.find(".wpProQuiz_cloze input").each(function(){if(""==j(this).val())return i=!1}),z.trigger({type:"questionSolved",values:{item:e,index:e.index(),solved:i}})}),z.find('.wpProQuiz_questionList[data-type="multiple"] .wpProQuiz_questionInput').change(function(e){var i=j(this).parents(".wpProQuiz_listItem"),t=0;i.find('.wpProQuiz_questionList[data-type="multiple"] .wpProQuiz_questionInput').each(function(e){this.checked&&t++}),z.trigger({type:"questionSolved",values:{item:i,index:i.index(),solved:!!t}})})},loadQuizDataAjax:function(i){w.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"quizLoadData",data:{quizId:l.quizId}},function(e){l.globalPoints=e.globalPoints,l.catPoints=e.catPoints,l.json=e.json,b.quiz.remove(),z.find(".wpProQuiz_quizAnker").after(e.content),b={back:z.find('input[name="back"]'),next:z.find(g),quiz:z.find(".wpProQuiz_quiz"),questionList:z.find(".wpProQuiz_list"),results:z.find(".wpProQuiz_results"),quizStartPage:z.find(".wpProQuiz_text"),timelimit:z.find(".wpProQuiz_time_limit"),toplistShowInButton:z.find(".wpProQuiz_toplistShowInButton"),listItems:j()},w.methode.initQuiz(),i&&w.methode.startQuiz(!0)})},initQuiz:function(){w.methode.setClozeStyle(),w.methode.registerSolved(),b.next.click(function(){if(v.forcingQuestionSolve&&!h[d.index()]&&(v.quizSummeryHide||!v.reviewQustion))return alert(WpProQuizGlobal.questionNotSolved),!1;w.methode.nextQuestion()}),b.back.click(function(){w.methode.prevQuestion()}),z.find(P).click(function(){if(v.forcingQuestionSolve&&!h[d.index()]&&(v.quizSummeryHide||!v.reviewQustion))return alert(WpProQuizGlobal.questionNotSolved),!1;w.methode.checkQuestion()}),z.find('input[name="checkSingle"]').click(function(){if(v.forcingQuestionSolve&&(v.quizSummeryHide||!v.reviewQustion))for(var e=0,i=z.find(".wpProQuiz_listItem").length;e<i;e++)if(!h[e])return alert(WpProQuizGlobal.questionsNotSolved),!1;w.methode.showQuizSummary()}),z.find('input[name="tip"]').click(w.methode.showTip),z.find('input[name="skip"]').click(w.methode.skipQuestion),z.find('input[name="wpProQuiz_pageLeft"]').click(function(){w.methode.showSinglePage(c-1)}),z.find('input[name="wpProQuiz_pageRight"]').click(function(){w.methode.showSinglePage(c+1)})}},w.preInit=function(){w.methode.parseBitOptions(),v.checkBeforeStart&&!v.preview&&w.methode.checkQuizLock(),z.find('input[name="startQuiz"]').click(function(){return w.methode.startQuiz(),!1}),z.find('input[name="reShowQuestion"]').click(function(){return w.methode.showQustionList(),!1}),z.find('input[name="restartQuiz"]').click(function(){return w.methode.restartQuiz(),!1}),z.find('input[name="review"]').click(function(){return w.methode.reviewQuestion(),!1}),z.find('input[name="wpProQuiz_toplistAdd"]').click(function(){return w.methode.addToplist(),!1}),z.find('input[name="quizSummary"]').click(function(){return w.methode.showQuizSummary(),!1}),z.find('input[name="endQuizSummary"]').click(function(){if(v.forcingQuestionSolve)for(var e=0,i=z.find(".wpProQuiz_listItem").length;e<i;e++)if(!h[e])return alert(WpProQuizGlobal.questionsNotSolved),!1;v.formActivated&&l.formPos==I&&!F.checkForm()||w.methode.finishQuiz()}),z.find('input[name="endInfopage"]').click(function(){return F.checkForm()&&w.methode.finishQuiz(),!1}),z.find('input[name="showToplist"]').click(function(){return b.quiz.hide(),b.toplistShowInButton.toggle(),!1}),z.bind("questionSolved",w.methode.questionSolved),C.init(),v.maxShowQuestion||w.methode.initQuiz(),v.autoStart&&w.methode.startQuiz()},w.preInit(),{token:"",isUser:0})},j.fn.wpProQuizFront=function(e){return this.each(function(){null==j(this).data("wpProQuizFront")&&j(this).data("wpProQuizFront",new j.wpProQuizFront(this,e))})}}(jQuery);